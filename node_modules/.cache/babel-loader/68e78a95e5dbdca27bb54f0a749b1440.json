{"ast":null,"code":"var _typeof2 = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n  return typeof e;\n} : function (e) {\n  return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n};\n\nfunction createCustomError(e) {\n  function n(e, n) {\n    Error.captureStackTrace && Error.captureStackTrace(this, this.constructor), this.message = e, this.code = n;\n  }\n\n  return n.prototype = new Error(), n.prototype.name = e, n.prototype.constructor = n, n;\n}\n\nvar LDUnexpectedResponseError = createCustomError(\"LaunchDarklyUnexpectedResponseError\"),\n    LDInvalidEnvironmentIdError = createCustomError(\"LaunchDarklyInvalidEnvironmentIdError\"),\n    LDInvalidUserError = createCustomError(\"LaunchDarklyInvalidUserError\"),\n    LDInvalidEventKeyError = createCustomError(\"LaunchDarklyInvalidEventKeyError\"),\n    LDInvalidArgumentError = createCustomError(\"LaunchDarklyInvalidArgumentError\"),\n    LDFlagFetchError = createCustomError(\"LaunchDarklyFlagFetchError\");\n\nfunction isHttpErrorRecoverable(e) {\n  return !(e >= 400 && e < 500) || 400 === e || 408 === e || 429 === e;\n}\n\nfor (var errors = Object.freeze({\n  LDUnexpectedResponseError: LDUnexpectedResponseError,\n  LDInvalidEnvironmentIdError: LDInvalidEnvironmentIdError,\n  LDInvalidUserError: LDInvalidUserError,\n  LDInvalidEventKeyError: LDInvalidEventKeyError,\n  LDInvalidArgumentError: LDInvalidArgumentError,\n  LDFlagFetchError: LDFlagFetchError,\n  isHttpErrorRecoverable: isHttpErrorRecoverable\n}), fromByteArray_1 = fromByteArray, lookup = [], revLookup = [], code = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\", i = 0, len = code.length; i < len; ++i) lookup[i] = code[i], revLookup[code.charCodeAt(i)] = i;\n\nfunction tripletToBase64(e) {\n  return lookup[e >> 18 & 63] + lookup[e >> 12 & 63] + lookup[e >> 6 & 63] + lookup[63 & e];\n}\n\nfunction encodeChunk(e, n, t) {\n  for (var r, o = [], i = n; i < t; i += 3) r = (e[i] << 16 & 16711680) + (e[i + 1] << 8 & 65280) + (255 & e[i + 2]), o.push(tripletToBase64(r));\n\n  return o.join(\"\");\n}\n\nfunction fromByteArray(e) {\n  for (var n, t = e.length, r = t % 3, o = [], i = 0, a = t - r; i < a; i += 16383) o.push(encodeChunk(e, i, i + 16383 > a ? a : i + 16383));\n\n  return 1 === r ? (n = e[t - 1], o.push(lookup[n >> 2] + lookup[n << 4 & 63] + \"==\")) : 2 === r && (n = (e[t - 2] << 8) + e[t - 1], o.push(lookup[n >> 10] + lookup[n >> 4 & 63] + lookup[n << 2 & 63] + \"=\")), o.join(\"\");\n}\n\nrevLookup[\"-\".charCodeAt(0)] = 62, revLookup[\"_\".charCodeAt(0)] = 63;\n\nvar _typeof = \"function\" == typeof Symbol && \"symbol\" == _typeof2(Symbol.iterator) ? function (e) {\n  return void 0 === e ? \"undefined\" : _typeof2(e);\n} : function (e) {\n  return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : void 0 === e ? \"undefined\" : _typeof2(e);\n},\n    isArray = Array.isArray,\n    keyList = Object.keys,\n    hasProp = Object.prototype.hasOwnProperty,\n    fastDeepEqual = function e(n, t) {\n  if (n === t) return !0;\n\n  if (n && t && \"object\" == (void 0 === n ? \"undefined\" : _typeof(n)) && \"object\" == (void 0 === t ? \"undefined\" : _typeof(t))) {\n    var r,\n        o,\n        i,\n        a = isArray(n),\n        u = isArray(t);\n\n    if (a && u) {\n      if ((o = n.length) != t.length) return !1;\n\n      for (r = o; 0 != r--;) if (!e(n[r], t[r])) return !1;\n\n      return !0;\n    }\n\n    if (a != u) return !1;\n    var s = n instanceof Date,\n        c = t instanceof Date;\n    if (s != c) return !1;\n    if (s && c) return n.getTime() == t.getTime();\n    var l = n instanceof RegExp,\n        d = t instanceof RegExp;\n    if (l != d) return !1;\n    if (l && d) return n.toString() == t.toString();\n    var v = keyList(n);\n    if ((o = v.length) !== keyList(t).length) return !1;\n\n    for (r = o; 0 != r--;) if (!hasProp.call(t, v[r])) return !1;\n\n    for (r = o; 0 != r--;) if (!e(n[i = v[r]], t[i])) return !1;\n\n    return !0;\n  }\n\n  return n != n && t != t;\n},\n    _extends = Object.assign || function (e) {\n  for (var n = 1; n < arguments.length; n++) {\n    var t = arguments[n];\n\n    for (var r in t) Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]);\n  }\n\n  return e;\n},\n    userAttrsToStringify = [\"key\", \"secondary\", \"ip\", \"country\", \"email\", \"firstName\", \"lastName\", \"avatar\", \"name\"];\n\nfunction btoa(e) {\n  var n = unescape(encodeURIComponent(e));\n  return fromByteArray_1(stringToBytes(n));\n}\n\nfunction stringToBytes(e) {\n  for (var n = [], t = 0; t < e.length; t++) n.push(e.charCodeAt(t));\n\n  return n;\n}\n\nfunction base64URLEncode(e) {\n  return btoa(e).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n}\n\nfunction clone(e) {\n  return JSON.parse(JSON.stringify(e));\n}\n\nfunction deepEquals(e, n) {\n  return fastDeepEqual(e, n);\n}\n\nfunction onNextTick(e) {\n  setTimeout(e, 0);\n}\n\nfunction wrapPromiseCallback(e, n) {\n  var t = e.then(function (e) {\n    return n && setTimeout(function () {\n      n(null, e);\n    }, 0), e;\n  }, function (e) {\n    if (!n) return Promise.reject(e);\n    setTimeout(function () {\n      n(e, null);\n    }, 0);\n  });\n  return n ? void 0 : t;\n}\n\nfunction transformValuesToVersionedValues(e) {\n  var n = {};\n\n  for (var t in e) e.hasOwnProperty(t) && (n[t] = {\n    value: e[t],\n    version: 0\n  });\n\n  return n;\n}\n\nfunction transformVersionedValuesToValues(e) {\n  var n = {};\n\n  for (var t in e) e.hasOwnProperty(t) && (n[t] = e[t].value);\n\n  return n;\n}\n\nfunction chunkUserEventsForUrl(e, n) {\n  for (var t = n.slice(0), r = [], o = e, i = void 0; t.length > 0;) {\n    for (i = []; o > 0;) {\n      var a = t.shift();\n      if (!a) break;\n      (o -= base64URLEncode(JSON.stringify(a)).length) < 0 && i.length > 0 ? t.unshift(a) : i.push(a);\n    }\n\n    o = e, r.push(i);\n  }\n\n  return r;\n}\n\nfunction getLDUserAgentString(e) {\n  var n = e.version || \"2.13.0\";\n  return e.userAgent + \"/\" + n;\n}\n\nfunction getLDHeaders(e) {\n  return {\n    \"X-LaunchDarkly-User-Agent\": getLDUserAgentString(e)\n  };\n}\n\nfunction extend() {\n  for (var e = arguments.length, n = Array(e), t = 0; t < e; t++) n[t] = arguments[t];\n\n  return n.reduce(function (e, n) {\n    return _extends({}, e, n);\n  }, {});\n}\n\nfunction sanitizeUser(e) {\n  if (!e) return e;\n  var n = void 0;\n\n  for (var t in userAttrsToStringify) {\n    var r = userAttrsToStringify[t],\n        o = e[r];\n    void 0 !== o && \"string\" != typeof o && ((n = n || Object.assign({}, e))[r] = String(o));\n  }\n\n  return n || e;\n}\n\nvar utils = Object.freeze({\n  btoa: btoa,\n  base64URLEncode: base64URLEncode,\n  clone: clone,\n  deepEquals: deepEquals,\n  onNextTick: onNextTick,\n  wrapPromiseCallback: wrapPromiseCallback,\n  transformValuesToVersionedValues: transformValuesToVersionedValues,\n  transformVersionedValuesToValues: transformVersionedValuesToValues,\n  chunkUserEventsForUrl: chunkUserEventsForUrl,\n  getLDUserAgentString: getLDUserAgentString,\n  getLDHeaders: getLDHeaders,\n  extend: extend,\n  sanitizeUser: sanitizeUser\n}),\n    MAX_URL_LENGTH = 2e3;\n\nfunction EventSender(e, n, t, r) {\n  var o = n + \"/events/bulk/\" + t,\n      i = n + \"/a/\" + t + \".gif\",\n      a = {};\n\n  function u(e) {\n    new window.Image().src = e;\n  }\n\n  function s(n, t) {\n    var a = r || u,\n        s = JSON.stringify(n);\n    return t ? function n(t) {\n      var r = extend({\n        \"Content-Type\": \"application/json\",\n        \"X-LaunchDarkly-Event-Schema\": \"3\"\n      }, getLDHeaders(e));\n      return e.httpRequest(\"POST\", o, r, s).promise.then(function (e) {\n        if (e) return e.status >= 400 && isHttpErrorRecoverable(e.status) && t ? n(!1) : function (e) {\n          var n = {\n            status: e.status\n          },\n              t = e.header(\"date\");\n\n          if (t) {\n            var r = Date.parse(t);\n            r && (n.serverTime = r);\n          }\n\n          return n;\n        }(e);\n      }).catch(function () {\n        return t ? n(!1) : Promise.reject();\n      });\n    }(!0).catch(function () {}) : (a(i + \"?d=\" + base64URLEncode(s)), Promise.resolve());\n  }\n\n  return a.sendEvents = function (t) {\n    if (!e.httpRequest) return Promise.resolve();\n    var r,\n        o = e.httpAllowsPost();\n    r = o ? [t] : chunkUserEventsForUrl(MAX_URL_LENGTH - n.length, t);\n\n    for (var i = [], a = 0; a < r.length; a++) i.push(s(r[a], o));\n\n    return Promise.all(i);\n  }, a;\n}\n\nfunction EventSummarizer() {\n  var e = {},\n      n = 0,\n      t = 0,\n      r = {};\n  return e.summarizeEvent = function (e) {\n    if (\"feature\" === e.kind) {\n      var o = e.key + \":\" + (null !== e.variation && void 0 !== e.variation ? e.variation : \"\") + \":\" + (null !== e.version && void 0 !== e.version ? e.version : \"\"),\n          i = r[o];\n      i ? i.count = i.count + 1 : r[o] = {\n        count: 1,\n        key: e.key,\n        variation: e.variation,\n        version: e.version,\n        value: e.value,\n        default: e.default\n      }, (0 === n || e.creationDate < n) && (n = e.creationDate), e.creationDate > t && (t = e.creationDate);\n    }\n  }, e.getSummary = function () {\n    var e = {},\n        o = !0;\n\n    for (var i in r) {\n      var a = r[i],\n          u = e[a.key];\n      u || (u = {\n        default: a.default,\n        counters: []\n      }, e[a.key] = u);\n      var s = {\n        value: a.value,\n        count: a.count\n      };\n      void 0 !== a.variation && null !== a.variation && (s.variation = a.variation), a.version ? s.version = a.version : s.unknown = !0, u.counters.push(s), o = !1;\n    }\n\n    return o ? null : {\n      startDate: n,\n      endDate: t,\n      features: e\n    };\n  }, e.clearSummary = function () {\n    n = 0, t = 0, r = {};\n  }, e;\n}\n\nfunction UserFilter(e) {\n  var n = {},\n      t = e.allAttributesPrivate,\n      r = e.privateAttributeNames || [],\n      o = {\n    key: !0,\n    custom: !0,\n    anonymous: !0\n  },\n      i = {\n    key: !0,\n    secondary: !0,\n    ip: !0,\n    country: !0,\n    email: !0,\n    firstName: !0,\n    lastName: !0,\n    avatar: !0,\n    name: !0,\n    anonymous: !0,\n    custom: !0\n  };\n  return n.filterUser = function (e) {\n    if (!e) return null;\n\n    var n = e.privateAttributeNames || [],\n        a = function (e, i) {\n      return Object.keys(e).reduce(function (a, u) {\n        var s = a;\n        return i(u) && (function (e) {\n          return !o[e] && (t || -1 !== n.indexOf(e) || -1 !== r.indexOf(e));\n        }(u) ? s[1][u] = !0 : s[0][u] = e[u]), s;\n      }, [{}, {}]);\n    },\n        u = a(e, function (e) {\n      return i[e];\n    }),\n        s = u[0],\n        c = u[1];\n\n    if (e.custom) {\n      var l = a(e.custom, function () {\n        return !0;\n      });\n      s.custom = l[0], c = extend({}, c, l[1]);\n    }\n\n    var d = Object.keys(c);\n    return d.length && (d.sort(), s.privateAttrs = d), s;\n  }, n;\n}\n\nfunction errorString(e) {\n  return e && e.message ? e.message : \"string\" == typeof e || e instanceof String ? e : JSON.stringify(e);\n}\n\nvar clientInitialized = function () {\n  return \"LaunchDarkly client initialized\";\n},\n    docLink = \" Please see https://docs.launchdarkly.com/docs/js-sdk-reference#section-initializing-the-client for instructions on SDK initialization.\",\n    clientNotReady = function () {\n  return \"LaunchDarkly client is not ready\";\n},\n    eventWithoutUser = function () {\n  return \"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/docs/js-sdk-reference#section-analytics-events\";\n},\n    invalidContentType = function (e) {\n  return 'Expected application/json content type but got \"' + e + '\"';\n},\n    invalidKey = function () {\n  return \"Event key must be a string\";\n},\n    localStorageUnavailable = function () {\n  return \"localStorage is unavailable\";\n},\n    localStorageUnavailableForUserId = function () {\n  return \"localStorage is unavailable, so anonymous user ID cannot be cached\";\n},\n    networkError = function (e) {\n  return \"network error\" + (e ? \" (\" + e + \")\" : \"\");\n},\n    unknownCustomEventKey = function (e) {\n  return 'Custom event \"' + e + '\" does not exist';\n},\n    environmentNotFound = function () {\n  return \"Environment not found. Double check that you specified a valid environment/client-side ID.\" + docLink;\n},\n    environmentNotSpecified = function () {\n  return \"No environment/client-side ID was specified.\" + docLink;\n},\n    errorFetchingFlags = function (e) {\n  return \"Error fetching flag settings: \" + errorString(e);\n},\n    userNotSpecified = function () {\n  return \"No user specified.\" + docLink;\n},\n    invalidUser = function () {\n  return \"Invalid user specified.\" + docLink;\n},\n    bootstrapOldFormat = function () {\n  return \"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly.\" + docLink;\n},\n    bootstrapInvalid = function () {\n  return \"LaunchDarkly bootstrap data is not available because the back end could not read the flags.\";\n},\n    deprecated = function (e, n) {\n  return '[LaunchDarkly] \"' + e + '\" is deprecated, please use \"' + n + '\"';\n},\n    httpErrorMessage = function (e, n, t) {\n  return \"Received error \" + e + (401 === e ? \" (invalid SDK key)\" : \"\") + \" for \" + n + \" - \" + (isHttpErrorRecoverable(e) ? t : \"giving up permanently\");\n},\n    httpUnavailable = function () {\n  return \"Cannot make HTTP requests in this environment.\" + docLink;\n},\n    identifyDisabled = function () {\n  return \"identify() has no effect here; it must be called on the main client instance\";\n},\n    streamClosing = function () {\n  return \"Closing stream connection\";\n},\n    streamConnecting = function (e) {\n  return \"Opening stream connection to \" + e;\n},\n    streamError = function (e) {\n  return \"Error on stream connection: \" + errorString(e);\n},\n    debugPolling = function (e) {\n  return \"polling for feature flags at \" + e;\n},\n    debugStreamPing = function () {\n  return \"received ping message from stream\";\n},\n    debugStreamPut = function () {\n  return \"received streaming update for all flags\";\n},\n    debugStreamPatch = function (e) {\n  return 'received streaming update for flag \"' + e + '\"';\n},\n    debugStreamPatchIgnored = function (e) {\n  return 'received streaming update for flag \"' + e + '\" but ignored due to version check';\n},\n    debugStreamDelete = function (e) {\n  return 'received streaming deletion for flag \"' + e + '\"';\n},\n    debugStreamDeleteIgnored = function (e) {\n  return 'received streaming deletion for flag \"' + e + '\" but ignored due to version check';\n},\n    debugEnqueueingEvent = function (e) {\n  return 'enqueueing \"' + e + '\" event';\n},\n    debugPostingEvents = function (e) {\n  return \"sending \" + e + \" events\";\n},\n    messages = Object.freeze({\n  clientInitialized: clientInitialized,\n  clientNotReady: clientNotReady,\n  eventWithoutUser: eventWithoutUser,\n  invalidContentType: invalidContentType,\n  invalidKey: invalidKey,\n  localStorageUnavailable: localStorageUnavailable,\n  localStorageUnavailableForUserId: localStorageUnavailableForUserId,\n  networkError: networkError,\n  unknownCustomEventKey: unknownCustomEventKey,\n  environmentNotFound: environmentNotFound,\n  environmentNotSpecified: environmentNotSpecified,\n  errorFetchingFlags: errorFetchingFlags,\n  userNotSpecified: userNotSpecified,\n  invalidUser: invalidUser,\n  bootstrapOldFormat: bootstrapOldFormat,\n  bootstrapInvalid: bootstrapInvalid,\n  deprecated: deprecated,\n  httpErrorMessage: httpErrorMessage,\n  httpUnavailable: httpUnavailable,\n  identifyDisabled: identifyDisabled,\n  streamClosing: streamClosing,\n  streamConnecting: streamConnecting,\n  streamError: streamError,\n  debugPolling: debugPolling,\n  debugStreamPing: debugStreamPing,\n  debugStreamPut: debugStreamPut,\n  debugStreamPatch: debugStreamPatch,\n  debugStreamPatchIgnored: debugStreamPatchIgnored,\n  debugStreamDelete: debugStreamDelete,\n  debugStreamDeleteIgnored: debugStreamDeleteIgnored,\n  debugEnqueueingEvent: debugEnqueueingEvent,\n  debugPostingEvents: debugPostingEvents\n});\n\nfunction EventProcessor(e, n, t) {\n  var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : null,\n      o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : null,\n      i = {},\n      a = o || EventSender(e, n.eventsUrl, t),\n      u = EventSummarizer(),\n      s = UserFilter(n),\n      c = n.inlineUsersInEvents,\n      l = n.samplingInterval,\n      d = n.flushInterval,\n      v = n.logger,\n      f = [],\n      g = 0,\n      p = !1,\n      m = void 0;\n\n  function y() {\n    return 0 === l || 0 === Math.floor(Math.random() * l);\n  }\n\n  return i.enqueue = function (e) {\n    if (!p) {\n      var n,\n          t = !1,\n          r = !1;\n\n      if (u.summarizeEvent(e), \"feature\" === e.kind ? y() && (t = !!e.trackEvents, r = !!(n = e).debugEventsUntilDate && n.debugEventsUntilDate > g && n.debugEventsUntilDate > new Date().getTime()) : t = y(), t && f.push(function (e) {\n        var n = extend({}, e);\n        return c || \"identify\" === e.kind ? n.user = s.filterUser(e.user) : (n.userKey = e.user.key, delete n.user), \"feature\" === e.kind && (delete n.trackEvents, delete n.debugEventsUntilDate), n;\n      }(e)), r) {\n        var o = extend({}, e, {\n          kind: \"debug\"\n        });\n        delete o.trackEvents, delete o.debugEventsUntilDate, delete o.variation, f.push(o);\n      }\n    }\n  }, i.flush = function () {\n    if (p) return Promise.resolve();\n    var e = f,\n        n = u.getSummary();\n    return u.clearSummary(), n && (n.kind = \"summary\", e.push(n)), 0 === e.length ? Promise.resolve() : (f = [], v.debug(debugPostingEvents(e.length)), a.sendEvents(e).then(function (e) {\n      e && (e.serverTime && (g = e.serverTime), isHttpErrorRecoverable(e.status) || (p = !0), e.status >= 400 && onNextTick(function () {\n        r.maybeReportError(new LDUnexpectedResponseError(httpErrorMessage(e.status, \"event posting\", \"some events were dropped\")));\n      }));\n    }));\n  }, i.start = function () {\n    m = setTimeout(function e() {\n      i.flush(), m = setTimeout(e, d);\n    }, d);\n  }, i.stop = function () {\n    clearTimeout(m);\n  }, i;\n}\n\nfunction EventEmitter(e) {\n  var n = {},\n      t = {};\n  return n.on = function (e, n, r) {\n    t[e] = t[e] || [], t[e] = t[e].concat({\n      handler: n,\n      context: r\n    });\n  }, n.off = function (e, n, r) {\n    if (t[e]) for (var o = 0; o < t[e].length; o++) t[e][o].handler === n && t[e][o].context === r && (t[e] = t[e].slice(0, o).concat(t[e].slice(o + 1)));\n  }, n.emit = function (e) {\n    if (t[e]) for (var n = 0; n < t[e].length; n++) t[e][n].handler.apply(t[e][n].context, Array.prototype.slice.call(arguments, 1));\n  }, n.getEvents = function () {\n    return Object.keys(t);\n  }, n.getEventListenerCount = function (e) {\n    return t[e] ? t[e].length : 0;\n  }, n.maybeReportError = function (n) {\n    n && (t.error ? this.emit(\"error\", n) : (e || console).error(n.message));\n  }, n;\n}\n\nfunction Store(e, n, t, r, o) {\n  var i = {};\n\n  function a() {\n    var e = \"\",\n        o = r.getUser();\n    return o && (e = t || btoa(JSON.stringify(o))), \"ld:\" + n + \":\" + e;\n  }\n\n  return i.loadFlags = function () {\n    return e.get(a()).then(function (e) {\n      if (null == e) return null;\n\n      try {\n        var n = JSON.parse(e);\n\n        if (n) {\n          var t = n.$schema;\n          void 0 === t || t < 1 ? n = transformValuesToVersionedValues(n) : delete n.$schema;\n        }\n\n        return n;\n      } catch (e) {\n        return i.clearFlags().then(function () {\n          return Promise.reject(e);\n        });\n      }\n    }).catch(function (e) {\n      return o.warn(localStorageUnavailable()), Promise.reject(e);\n    });\n  }, i.saveFlags = function (n) {\n    var t = extend({}, n, {\n      $schema: 1\n    });\n    return e.set(a(), JSON.stringify(t)).catch(function (e) {\n      return o.warn(localStorageUnavailable()), Promise.reject(e);\n    });\n  }, i.clearFlags = function () {\n    return e.clear(a()).catch(function (e) {\n      return o.warn(localStorageUnavailable()), Promise.reject(e);\n    });\n  }, i;\n}\n\nfunction Stream(e, n, t, r) {\n  var o = n.streamUrl,\n      i = n.logger,\n      a = {},\n      u = o + \"/eval/\" + t,\n      s = n.useReport,\n      c = n.evaluationReasons,\n      l = n.streamReconnectDelay,\n      d = null,\n      v = null,\n      f = null,\n      g = null;\n\n  function p(e) {\n    i.warn(streamError(e)), h(), m(l);\n  }\n\n  function m(e) {\n    v || (e ? v = setTimeout(y, e) : y());\n  }\n\n  function y() {\n    v = null;\n    var n = void 0,\n        a = \"\",\n        l = {};\n\n    if (e.eventSourceFactory) {\n      for (var m in null != r && (a = \"h=\" + r), s ? e.eventSourceAllowsReport ? (n = u, l.method = \"REPORT\", l.headers = {\n        \"Content-Type\": \"application/json\"\n      }, l.body = JSON.stringify(f)) : (n = o + \"/ping/\" + t, a = \"\") : n = u + \"/\" + base64URLEncode(JSON.stringify(f)), c && (a = a + (a ? \"&\" : \"\") + \"withReasons=true\"), n = n + (a ? \"?\" : \"\") + a, h(), i.info(streamConnecting(n)), d = e.eventSourceFactory(n, l), g) g.hasOwnProperty(m) && d.addEventListener(m, g[m]);\n\n      d.onerror = p;\n    }\n  }\n\n  function h() {\n    d && (i.info(streamClosing()), d.close(), d = null);\n  }\n\n  return a.connect = function (e, n) {\n    f = e, g = n, m();\n  }, a.disconnect = function () {\n    clearTimeout(v), v = null, h();\n  }, a.isConnected = function () {\n    return !!(d && e.eventSourceIsActive && e.eventSourceIsActive(d));\n  }, a;\n}\n\nfunction promiseCoalescer(e) {\n  var n = void 0,\n      t = void 0,\n      r = void 0,\n      o = void 0,\n      i = {\n    addPromise: function (i, a) {\n      n = i, t && t(), t = a, i.then(function (t) {\n        n === i && (r(t), e && e());\n      }, function (t) {\n        n === i && (o(t), e && e());\n      });\n    }\n  };\n  return i.resultPromise = new Promise(function (e, n) {\n    r = e, o = n;\n  }), i;\n}\n\nvar json = \"application/json\";\n\nfunction getResponseError(e) {\n  return 404 === e.status ? new LDInvalidEnvironmentIdError(environmentNotFound()) : new LDFlagFetchError(errorFetchingFlags(e.statusText || String(e.status)));\n}\n\nfunction Requestor(e, n, t) {\n  var r = n.baseUrl,\n      o = n.useReport,\n      i = n.evaluationReasons,\n      a = n.sendLDHeaders,\n      u = n.logger,\n      s = {},\n      c = {};\n\n  function l(n, t) {\n    if (!e.httpRequest) return new Promise(function (e, n) {\n      n(new LDFlagFetchError(httpUnavailable()));\n    });\n    var r = t ? \"REPORT\" : \"GET\",\n        o = a ? getLDHeaders(e) : {};\n    t && (o[\"Content-Type\"] = \"application/json\");\n    var i = c[n];\n    i || (i = promiseCoalescer(function () {\n      delete c[n];\n    }), c[n] = i);\n    var u = e.httpRequest(r, n, o, t),\n        s = u.promise.then(function (e) {\n      if (200 === e.status) {\n        if (e.header(\"content-type\") && 0 === e.header(\"content-type\").lastIndexOf(json)) return JSON.parse(e.body);\n        var n = invalidContentType(e.header(\"content-type\") || \"\");\n        return Promise.reject(new LDFlagFetchError(n));\n      }\n\n      return Promise.reject(getResponseError(e));\n    }, function (e) {\n      return Promise.reject(new LDFlagFetchError(networkError(e)));\n    });\n    return i.addPromise(s, function () {\n      u.cancel && u.cancel();\n    }), i.resultPromise;\n  }\n\n  return s.fetchJSON = function (e) {\n    return l(r + e, null);\n  }, s.fetchFlagSettings = function (e, n) {\n    var a = void 0,\n        s = void 0,\n        c = \"\",\n        d = void 0;\n    return o ? (s = [r, \"/sdk/evalx/\", t, \"/user\"].join(\"\"), d = JSON.stringify(e)) : (a = base64URLEncode(JSON.stringify(e)), s = [r, \"/sdk/evalx/\", t, \"/users/\", a].join(\"\")), n && (c = \"h=\" + n), i && (c = c + (c ? \"&\" : \"\") + \"withReasons=true\"), s = s + (c ? \"?\" : \"\") + c, u.debug(debugPolling(s)), l(s, d);\n  }, s;\n}\n\nfunction Identity(e, n) {\n  var t = {},\n      r = void 0;\n  return t.setUser = function (e) {\n    (r = sanitizeUser(e)) && n && n(clone(r));\n  }, t.getUser = function () {\n    return r ? clone(r) : null;\n  }, e && t.setUser(e), t;\n}\n\nfunction createCommonjsModule(e, n) {\n  return e(n = {\n    exports: {}\n  }, n.exports), n.exports;\n}\n\nfor (var rngBrowser = createCommonjsModule(function (e) {\n  var n = \"undefined\" != typeof crypto && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || \"undefined\" != typeof msCrypto && \"function\" == typeof window.msCrypto.getRandomValues && msCrypto.getRandomValues.bind(msCrypto);\n\n  if (n) {\n    var t = new Uint8Array(16);\n\n    e.exports = function () {\n      return n(t), t;\n    };\n  } else {\n    var r = new Array(16);\n\n    e.exports = function () {\n      for (var e, n = 0; n < 16; n++) 0 == (3 & n) && (e = 4294967296 * Math.random()), r[n] = e >>> ((3 & n) << 3) & 255;\n\n      return r;\n    };\n  }\n}), byteToHex = [], i$1 = 0; i$1 < 256; ++i$1) byteToHex[i$1] = (i$1 + 256).toString(16).substr(1);\n\nfunction bytesToUuid(e, n) {\n  var t = n || 0,\n      r = byteToHex;\n  return [r[e[t++]], r[e[t++]], r[e[t++]], r[e[t++]], \"-\", r[e[t++]], r[e[t++]], \"-\", r[e[t++]], r[e[t++]], \"-\", r[e[t++]], r[e[t++]], \"-\", r[e[t++]], r[e[t++]], r[e[t++]], r[e[t++]], r[e[t++]], r[e[t++]]].join(\"\");\n}\n\nvar _nodeId,\n    _clockseq,\n    bytesToUuid_1 = bytesToUuid,\n    _lastMSecs = 0,\n    _lastNSecs = 0;\n\nfunction v1(e, n, t) {\n  var r = n && t || 0,\n      o = n || [],\n      i = (e = e || {}).node || _nodeId,\n      a = void 0 !== e.clockseq ? e.clockseq : _clockseq;\n\n  if (null == i || null == a) {\n    var u = rngBrowser();\n    null == i && (i = _nodeId = [1 | u[0], u[1], u[2], u[3], u[4], u[5]]), null == a && (a = _clockseq = 16383 & (u[6] << 8 | u[7]));\n  }\n\n  var s = void 0 !== e.msecs ? e.msecs : new Date().getTime(),\n      c = void 0 !== e.nsecs ? e.nsecs : _lastNSecs + 1,\n      l = s - _lastMSecs + (c - _lastNSecs) / 1e4;\n  if (l < 0 && void 0 === e.clockseq && (a = a + 1 & 16383), (l < 0 || s > _lastMSecs) && void 0 === e.nsecs && (c = 0), c >= 1e4) throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  _lastMSecs = s, _lastNSecs = c, _clockseq = a;\n  var d = (1e4 * (268435455 & (s += 122192928e5)) + c) % 4294967296;\n  o[r++] = d >>> 24 & 255, o[r++] = d >>> 16 & 255, o[r++] = d >>> 8 & 255, o[r++] = 255 & d;\n  var v = s / 4294967296 * 1e4 & 268435455;\n  o[r++] = v >>> 8 & 255, o[r++] = 255 & v, o[r++] = v >>> 24 & 15 | 16, o[r++] = v >>> 16 & 255, o[r++] = a >>> 8 | 128, o[r++] = 255 & a;\n\n  for (var f = 0; f < 6; ++f) o[r + f] = i[f];\n\n  return n || bytesToUuid_1(o);\n}\n\nvar v1_1 = v1,\n    ldUserIdKey = \"ld:$anonUserId\";\n\nfunction UserValidator(e, n) {\n  var t = {\n    validateUser: function (t) {\n      if (!t) return Promise.reject(new LDInvalidUserError(userNotSpecified()));\n      var r = clone(t);\n      return null !== r.key && void 0 !== r.key ? (r.key = r.key.toString(), Promise.resolve(r)) : r.anonymous ? (e ? e.get(ldUserIdKey).catch(function () {\n        return null;\n      }) : Promise.resolve(null)).then(function (t) {\n        if (t) return r.key = t, r;\n        var o = v1_1();\n        return r.key = o, function (t) {\n          return e ? e.set(ldUserIdKey, t).catch(function () {\n            n.warn(localStorageUnavailableForUserId());\n          }) : Promise.resolve();\n        }(o).then(function () {\n          return r;\n        });\n      }) : Promise.reject(new LDInvalidUserError(invalidUser()));\n    }\n  };\n  return t;\n}\n\nfunction validate(e, n, t, r) {\n  var o = extend({\n    logger: r\n  }, {\n    baseUrl: \"https://app.launchdarkly.com\",\n    streamUrl: \"https://clientstream.launchdarkly.com\",\n    eventsUrl: \"https://events.launchdarkly.com\",\n    sendEvents: !0,\n    sendLDHeaders: !0,\n    inlineUsersInEvents: !1,\n    allowFrequentDuplicateEvents: !1,\n    sendEventsOnlyForVariation: !1,\n    useReport: !1,\n    evaluationReasons: !1,\n    flushInterval: 2e3,\n    samplingInterval: 0,\n    streamReconnectDelay: 1e3,\n    allAttributesPrivate: !1,\n    privateAttributeNames: []\n  }, t),\n      i = {\n    all_attributes_private: \"allAttributesPrivate\",\n    private_attribute_names: \"privateAttributeNames\"\n  };\n\n  function a(e) {\n    onNextTick(function () {\n      n && n.maybeReportError(new LDInvalidArgumentError(e));\n    });\n  }\n\n  var u = extend({}, e || {});\n  return function (e) {\n    var n = u;\n    Object.keys(i).forEach(function (e) {\n      if (void 0 !== n[e]) {\n        var t = i[e];\n        r.warn(deprecated(e, t)), void 0 === n[t] && (n[t] = n[e]), delete n[e];\n      }\n    });\n  }(), u = function (e, n) {\n    var t = extend({}, u);\n    return Object.keys(n).forEach(function (e) {\n      void 0 !== t[e] && null !== t[e] || (t[e] = n[e]);\n    }), t;\n  }(0, o), (isNaN(u.flushInterval) || u.flushInterval < 2e3) && (u.flushInterval = 2e3, a(\"Invalid flush interval configured. Must be an integer >= 2000 (milliseconds).\")), (isNaN(u.samplingInterval) || u.samplingInterval < 0) && (u.samplingInterval = 0, a(\"Invalid sampling interval configured. Sampling interval must be an integer >= 0.\")), u;\n}\n\nfunction createConsoleLogger(e) {\n  var n = 0;\n  e && (n = \"none\" === e ? 100 : [\"debug\", \"info\", \"warn\", \"error\"].indexOf(e));\n  var t = {};\n\n  function r(e, t, r) {\n    e >= n && t(r);\n  }\n\n  return t.debug = function (e) {\n    return r(0, console.log, e);\n  }, t.info = function (e) {\n    return r(1, console.info, e);\n  }, t.warn = function (e) {\n    return r(2, console.warn, e);\n  }, t.error = function (e) {\n    return r(3, console.error, e);\n  }, t;\n}\n\nvar _typeof$1 = \"function\" == typeof Symbol && \"symbol\" == _typeof2(Symbol.iterator) ? function (e) {\n  return void 0 === e ? \"undefined\" : _typeof2(e);\n} : function (e) {\n  return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : void 0 === e ? \"undefined\" : _typeof2(e);\n},\n    readyEvent = \"ready\",\n    successEvent = \"initialized\",\n    failedEvent = \"failed\",\n    changeEvent = \"change\",\n    internalChangeEvent = \"internal-change\";\n\nfunction initialize(e, n, t, r, o) {\n  var i = t && t.logger ? t.logger : o && o.logger || createConsoleLogger(\"warn\"),\n      a = EventEmitter(i),\n      u = validate(t, a, o, i),\n      s = u.hash,\n      c = u.sendEvents,\n      l = e,\n      d = Stream(r, u, l, s),\n      v = u.eventProcessor || EventProcessor(r, u, l, a),\n      f = Requestor(r, u, l),\n      g = {},\n      p = {},\n      m = void 0,\n      y = void 0,\n      h = u.streaming,\n      E = void 0,\n      b = !1,\n      w = !1,\n      k = !0,\n      S = u.stateProvider,\n      U = Identity(null, function (e) {\n    S || e && L({\n      kind: \"identify\",\n      key: e.key,\n      user: e,\n      creationDate: new Date().getTime()\n    });\n  }),\n      D = UserValidator(r.localStorage, i),\n      P = void 0;\n\n  function L(e) {\n    l && (S && S.enqueueEvent && S.enqueueEvent(e) || (e.user ? (k = !1, !c || w || r.isDoNotTrack() || (i.debug(debugEnqueueingEvent(e.kind)), v.enqueue(e))) : k && (i.warn(eventWithoutUser()), k = !1)));\n  }\n\n  function I(e, n, t) {\n    var r = U.getUser(),\n        o = new Date(),\n        i = n ? n.value : null;\n\n    if (!u.allowFrequentDuplicateEvents) {\n      var a = JSON.stringify(i) + (r && r.key ? r.key : \"\") + e,\n          s = g[a];\n      if (s && o - s < 3e5) return;\n      g[a] = o;\n    }\n\n    var c = {\n      kind: \"feature\",\n      key: e,\n      user: r,\n      value: i,\n      variation: n ? n.variationIndex : null,\n      default: t,\n      creationDate: o.getTime(),\n      reason: n ? n.reason : null\n    },\n        l = p[e];\n    l && (c.version = l.flagVersion ? l.flagVersion : l.version, c.trackEvents = l.trackEvents, c.debugEventsUntilDate = l.debugEventsUntilDate), L(c);\n  }\n\n  function R(e, n, t) {\n    var r = void 0;\n\n    if (p && p.hasOwnProperty(e) && p[e] && !p[e].deleted) {\n      var o = p[e];\n      r = T(o), null !== o.value && void 0 !== o.value || (r.value = n);\n    } else r = {\n      value: n,\n      variationIndex: null,\n      reason: {\n        kind: \"ERROR\",\n        errorKind: \"FLAG_NOT_FOUND\"\n      }\n    };\n\n    return t && I(e, r, n), r;\n  }\n\n  function T(e) {\n    return {\n      value: e.value,\n      variationIndex: void 0 === e.variation ? null : e.variation,\n      reason: e.reason || null\n    };\n  }\n\n  function C() {\n    y = !0, U.getUser() && d.connect(U.getUser(), {\n      ping: function () {\n        i.debug(debugStreamPing()), f.fetchFlagSettings(U.getUser(), s).then(function (e) {\n          return N(e || {});\n        }).catch(function (e) {\n          a.maybeReportError(new LDFlagFetchError(errorFetchingFlags(e)));\n        });\n      },\n      put: function (e) {\n        var n = JSON.parse(e.data);\n        i.debug(debugStreamPut()), N(n);\n      },\n      patch: function (e) {\n        var n = JSON.parse(e.data),\n            t = p[n.key];\n\n        if (!t || !t.version || !n.version || t.version < n.version) {\n          i.debug(debugStreamPatch(n.key));\n          var r = {},\n              o = extend({}, n);\n          delete o.key, p[n.key] = o;\n          var a = T(o);\n          r[n.key] = t ? {\n            previous: t.value,\n            current: a\n          } : {\n            current: a\n          }, x(r);\n        } else i.debug(debugStreamPatchIgnored(n.key));\n      },\n      delete: function (e) {\n        var n = JSON.parse(e.data);\n\n        if (!p[n.key] || p[n.key].version < n.version) {\n          i.debug(debugStreamDelete(n.key));\n          var t = {};\n          p[n.key] && !p[n.key].deleted && (t[n.key] = {\n            previous: p[n.key].value\n          }), p[n.key] = {\n            version: n.version,\n            deleted: !0\n          }, x(t);\n        } else i.debug(debugStreamDeleteIgnored(n.key));\n      }\n    });\n  }\n\n  function F() {\n    y && (d.disconnect(), y = !1);\n  }\n\n  function N(e) {\n    var n = {};\n    if (!e) return Promise.resolve();\n\n    for (var t in p) p.hasOwnProperty(t) && p[t] && (e[t] && !deepEquals(e[t].value, p[t].value) ? n[t] = {\n      previous: p[t].value,\n      current: T(e[t])\n    } : e[t] && !e[t].deleted || (n[t] = {\n      previous: p[t].value\n    }));\n\n    for (var r in e) e.hasOwnProperty(r) && e[r] && (!p[r] || p[r].deleted) && (n[r] = {\n      current: T(e[r])\n    });\n\n    return p = Object.assign({}, e), x(n).catch(function () {});\n  }\n\n  function x(e) {\n    var n = Object.keys(e);\n\n    if (n.length > 0) {\n      var t = {};\n      n.forEach(function (n) {\n        var r = e[n].current,\n            o = r ? r.value : void 0,\n            i = e[n].previous;\n        a.emit(changeEvent + \":\" + n, o, i), t[n] = r ? {\n          current: o,\n          previous: i\n        } : {\n          previous: i\n        };\n      }), a.emit(changeEvent, t), a.emit(internalChangeEvent, p), u.sendEventsOnlyForVariation || S || n.forEach(function (n) {\n        I(n, e[n].current);\n      });\n    }\n\n    return m && P ? P.saveFlags(p).catch(function () {\n      return null;\n    }) : Promise.resolve();\n  }\n\n  function O() {\n    var e = h || E && void 0 === h;\n    e && !y ? C() : !e && y && F();\n  }\n\n  function A(e) {\n    return e === changeEvent || e.substr(0, changeEvent.length + 1) === changeEvent + \":\";\n  }\n\n  r.localStorage && (P = new Store(r.localStorage, l, s, U, i));\n\n  var j = new Promise(function (e) {\n    var n = a.on(readyEvent, function () {\n      a.off(readyEvent, n), e();\n    });\n  }),\n      _ = new Promise(function (e, n) {\n    var t = a.on(successEvent, function () {\n      a.off(successEvent, t), e();\n    }),\n        r = a.on(failedEvent, function (e) {\n      a.off(failedEvent, r), n(e);\n    });\n  });\n\n  if (\"string\" == typeof u.bootstrap && \"LOCALSTORAGE\" === u.bootstrap.toUpperCase() && (P ? m = !0 : i.warn(localStorageUnavailable())), \"object\" === _typeof$1(u.bootstrap) && (p = function (e) {\n    var n = Object.keys(e),\n        t = e.$flagsState;\n    !t && n.length && i.warn(bootstrapOldFormat()), !1 === e.$valid && i.warn(bootstrapInvalid());\n    var r = {};\n    return n.forEach(function (n) {\n      if (\"$flagsState\" !== n && \"$valid\" !== n) {\n        var o = {\n          value: e[n]\n        };\n        t && t[n] ? o = extend(o, t[n]) : o.version = 0, r[n] = o;\n      }\n    }), r;\n  }(u.bootstrap)), S) {\n    var q = S.getInitialState();\n    q ? V(q) : S.on(\"init\", V), S.on(\"update\", function (e) {\n      e.user && U.setUser(e.user), e.flags && N(e.flags);\n    });\n  } else (e ? D.validateUser(n).then(function (e) {\n    return U.setUser(e), \"object\" === _typeof$1(u.bootstrap) ? z() : m ? P.loadFlags().catch(function () {\n      return null;\n    }).then(function (e) {\n      return null == e ? (p = {}, f.fetchFlagSettings(U.getUser(), s).then(function (e) {\n        return N(e || {});\n      }).then(z).catch(function (e) {\n        H(new LDFlagFetchError(errorFetchingFlags(e)));\n      })) : (p = e, onNextTick(z), f.fetchFlagSettings(U.getUser(), s).then(function (e) {\n        return N(e);\n      }).catch(function (e) {\n        return a.maybeReportError(e);\n      }));\n    }) : f.fetchFlagSettings(U.getUser(), s).then(function (e) {\n      p = e || {}, z();\n    }).catch(function (e) {\n      p = {}, H(e);\n    });\n  }) : Promise.reject(new LDInvalidEnvironmentIdError(environmentNotSpecified()))).catch(function (e) {\n    return a.maybeReportError(e);\n  });\n\n  function V(e) {\n    l = e.environment, U.setUser(e.user), p = Object.assign({}, e.flags), onNextTick(z);\n  }\n\n  function z() {\n    i.info(clientInitialized()), b = !0, O(), a.emit(readyEvent), a.emit(successEvent);\n  }\n\n  function H(e) {\n    a.maybeReportError(e), a.emit(failedEvent, e), a.emit(readyEvent);\n  }\n\n  return {\n    client: {\n      waitForInitialization: function () {\n        return _;\n      },\n      waitUntilReady: function () {\n        return j;\n      },\n      identify: function (e, n, t) {\n        return w ? wrapPromiseCallback(Promise.resolve({}), t) : S ? (i.warn(identifyDisabled()), wrapPromiseCallback(Promise.resolve(transformVersionedValuesToValues(p)), t)) : wrapPromiseCallback((m && P ? P.clearFlags() : Promise.resolve()).then(function () {\n          return D.validateUser(e);\n        }).then(function (e) {\n          return U.setUser(e);\n        }).then(function () {\n          return f.fetchFlagSettings(U.getUser(), n);\n        }).then(function (e) {\n          var n = transformVersionedValuesToValues(e);\n          return e ? N(e).then(function () {\n            return n;\n          }) : n;\n        }).then(function (e) {\n          return y && C(), e;\n        }).catch(function (e) {\n          return a.maybeReportError(e), Promise.reject(e);\n        }), t);\n      },\n      getUser: function () {\n        return U.getUser();\n      },\n      variation: function (e, n) {\n        return R(e, n, !0).value;\n      },\n      variationDetail: function (e, n) {\n        return R(e, n, !0);\n      },\n      track: function (e, n) {\n        \"string\" == typeof e ? (r.customEventFilter && !r.customEventFilter(e) && i.warn(unknownCustomEventKey(e)), L({\n          kind: \"custom\",\n          key: e,\n          data: n,\n          user: U.getUser(),\n          url: r.getCurrentUrl(),\n          creationDate: new Date().getTime()\n        })) : a.maybeReportError(new LDInvalidEventKeyError(unknownCustomEventKey(e)));\n      },\n      on: function (e, n, t) {\n        A(e) ? (E = !0, b && O(), a.on(e, n, t)) : a.on.apply(a, arguments);\n      },\n      off: function (e) {\n        if (a.off.apply(a, arguments), A(e)) {\n          var n = !1;\n          a.getEvents().forEach(function (e) {\n            A(e) && a.getEventListenerCount(e) > 0 && (n = !0);\n          }), n || (E = !1, y && void 0 === h && F());\n        }\n      },\n      setStreaming: function (e) {\n        var n = null === e ? void 0 : e;\n        n !== h && (h = n, O());\n      },\n      flush: function (e) {\n        return wrapPromiseCallback(c ? v.flush() : Promise.resolve(), e);\n      },\n      allFlags: function () {\n        var e = {};\n        if (!p) return e;\n\n        for (var n in p) p.hasOwnProperty(n) && (e[n] = R(n, null, !u.sendEventsOnlyForVariation).value);\n\n        return e;\n      },\n      close: function (e) {\n        if (w) return wrapPromiseCallback(Promise.resolve(), e);\n\n        var n = function () {\n          w = !0, p = {};\n        };\n\n        return wrapPromiseCallback(Promise.resolve().then(function () {\n          if (F(), c) return v.stop(), v.flush();\n        }).then(n).catch(n), e);\n      }\n    },\n    options: u,\n    emitter: a,\n    ident: U,\n    logger: i,\n    requestor: f,\n    start: function () {\n      c && v.start();\n    },\n    enqueueEvent: L,\n    getFlagsInternal: function () {\n      return p;\n    },\n    getEnvironmentId: function () {\n      return l;\n    },\n    internalChangeEventName: internalChangeEvent\n  };\n}\n\nvar version = \"2.13.0\";\n\nfunction isSyncXhrSupported() {\n  var e = window.navigator && window.navigator.userAgent;\n\n  if (e) {\n    var n = e.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n    if (n) return parseInt(n[2], 10) < 73;\n  }\n\n  return !0;\n}\n\nvar emptyResult = {\n  promise: Promise.resolve({\n    status: 200,\n    header: function () {\n      return null;\n    },\n    body: null\n  })\n};\n\nfunction newHttpRequest(e, n, t, r, o) {\n  if (o && !isSyncXhrSupported()) return emptyResult;\n  var i = new window.XMLHttpRequest();\n\n  for (var a in i.open(e, n, !o), t || {}) t.hasOwnProperty(a) && i.setRequestHeader(a, t[a]);\n\n  if (o) return i.send(r), emptyResult;\n  var u = void 0;\n  return {\n    promise: new Promise(function (e, n) {\n      i.addEventListener(\"load\", function () {\n        u || e({\n          status: i.status,\n          header: function (e) {\n            return i.getResponseHeader(e);\n          },\n          body: i.responseText\n        });\n      }), i.addEventListener(\"error\", function () {\n        u || n(new Error());\n      }), i.send(r);\n    }),\n    cancel: function () {\n      u = !0, i.abort();\n    }\n  };\n}\n\nfunction makeBrowserPlatform(e) {\n  var n = {\n    pageIsClosing: !1\n  };\n  window.XMLHttpRequest && (n.httpRequest = function (e, t, r, o) {\n    return newHttpRequest(e, t, r, o, n.pageIsClosing);\n  });\n  var t = void 0;\n\n  n.httpAllowsPost = function () {\n    return void 0 === t && (t = !!window.XMLHttpRequest && \"withCredentials\" in new window.XMLHttpRequest()), t;\n  };\n\n  var r = e && e.eventUrlTransformer;\n  n.getCurrentUrl = function () {\n    return r ? r(window.location.href) : window.location.href;\n  }, n.isDoNotTrack = function () {\n    var e = void 0;\n    return 1 === (e = window.navigator && void 0 !== window.navigator.doNotTrack ? window.navigator.doNotTrack : window.navigator && void 0 !== window.navigator.msDoNotTrack ? window.navigator.msDoNotTrack : window.doNotTrack) || !0 === e || \"1\" === e || \"yes\" === e;\n  };\n\n  try {\n    window.localStorage && (n.localStorage = {\n      get: function (e) {\n        return new Promise(function (n) {\n          n(window.localStorage.getItem(e));\n        });\n      },\n      set: function (e, n) {\n        return new Promise(function (t) {\n          window.localStorage.setItem(e, n), t();\n        });\n      },\n      clear: function (e) {\n        return new Promise(function (n) {\n          window.localStorage.removeItem(e), n();\n        });\n      }\n    });\n  } catch (e) {\n    n.localStorage = null;\n  }\n\n  var o = void 0;\n\n  if (e && e.useReport && \"function\" == typeof window.EventSourcePolyfill && window.EventSourcePolyfill.supportedOptions && window.EventSourcePolyfill.supportedOptions.method ? (n.eventSourceAllowsReport = !0, o = window.EventSourcePolyfill) : (n.eventSourceAllowsReport = !1, o = window.EventSource), window.EventSource) {\n    n.eventSourceFactory = function (e, n) {\n      var t = {\n        heartbeatTimeout: 3e5,\n        silentTimeout: 3e5,\n        skipDefaultHeaders: !0\n      },\n          r = Object.assign({}, t, n);\n      return new o(e, r);\n    }, n.eventSourceIsActive = function (e) {\n      return e.readyState === window.EventSource.OPEN || e.readyState === window.EventSource.CONNECTING;\n    };\n  }\n\n  return n.userAgent = \"JSClient\", n;\n}\n\nvar matchOperatorsRe = /[|\\\\{}()[\\]^$+*?.]/g,\n    escapeStringRegexp = function (e) {\n  if (\"string\" != typeof e) throw new TypeError(\"Expected a string\");\n  return e.replace(matchOperatorsRe, \"\\\\$&\");\n};\n\nfunction doesUrlMatch(e, n, t, r) {\n  var o = n.replace(t, \"\").replace(r, \"\"),\n      i = void 0,\n      a = void 0;\n\n  switch (e.kind) {\n    case \"exact\":\n      a = n, i = new RegExp(\"^\" + escapeStringRegexp(e.url) + \"/?$\");\n      break;\n\n    case \"canonical\":\n      a = o, i = new RegExp(\"^\" + escapeStringRegexp(e.url) + \"/?$\");\n      break;\n\n    case \"substring\":\n      a = o, i = new RegExp(\".*\" + escapeStringRegexp(e.substring) + \".*$\");\n      break;\n\n    case \"regex\":\n      a = o, i = new RegExp(e.pattern);\n      break;\n\n    default:\n      return !1;\n  }\n\n  return i.test(a);\n}\n\nfunction findGoalsForClick(e, n) {\n  for (var t = [], r = 0; r < n.length; r++) for (var o = e.target, i = n[r], a = i.selector, u = document.querySelectorAll(a); o && u.length > 0;) {\n    for (var s = 0; s < u.length; s++) o === u[s] && t.push(i);\n\n    o = o.parentNode;\n  }\n\n  return t;\n}\n\nfunction GoalTracker(e, n) {\n  for (var t = {}, r = null, o = [], i = 0; i < e.length; i++) for (var a = e[i], u = a.urls || [], s = 0; s < u.length; s++) if (doesUrlMatch(u[s], window.location.href, window.location.search, window.location.hash)) {\n    \"pageview\" === a.kind ? n(\"pageview\", a) : (o.push(a), n(\"click_pageview\", a));\n    break;\n  }\n\n  return o.length > 0 && (r = function (e) {\n    for (var t = findGoalsForClick(e, o), r = 0; r < t.length; r++) n(\"click\", t[r]);\n  }, document.addEventListener(\"click\", r)), t.dispose = function () {\n    document.removeEventListener(\"click\", r);\n  }, t;\n}\n\nvar locationWatcherInterval = 300;\n\nfunction GoalManager(e, n) {\n  var t = void 0,\n      r = void 0,\n      o = {};\n\n  function i() {\n    r && r.dispose(), t && t.length && (r = GoalTracker(t, a));\n  }\n\n  function a(n, t) {\n    var r = {\n      kind: n,\n      key: t.key,\n      data: null,\n      url: window.location.href,\n      user: e.ident.getUser(),\n      creationDate: new Date().getTime()\n    };\n    return \"click\" === n && (r.selector = t.selector), e.enqueueEvent(r);\n  }\n\n  return o.goalKeyExists = function (e) {\n    if (!t) return !0;\n\n    for (var n = 0; n < t.length; n++) if (\"custom\" === t[n].kind && t[n].key === e) return !0;\n\n    return !1;\n  }, e.requestor.fetchJSON(\"/sdk/goals/\" + e.getEnvironmentId()).then(function (e) {\n    e && e.length > 0 && (r = GoalTracker(t = e, a), function (e, n) {\n      var t = window.location.href,\n          r = void 0;\n\n      function o() {\n        (r = window.location.href) !== t && (t = r, n());\n      }\n\n      !function e(n, t) {\n        n(), setTimeout(function () {\n          e(n, t);\n        }, t);\n      }(o, e), window.history && window.history.pushState ? window.addEventListener(\"popstate\", o) : window.addEventListener(\"hashchange\", o);\n    }(locationWatcherInterval, i)), n();\n  }).catch(function (t) {\n    e.emitter.maybeReportError(new errors.LDUnexpectedResponseError((t && t.message, t.message))), n();\n  }), o;\n}\n\nvar goalsEvent = \"goalsReady\",\n    extraDefaults = {\n  fetchGoals: !0\n};\n\nfunction initialize$1(e, n) {\n  var t = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},\n      r = makeBrowserPlatform(t),\n      o = initialize(e, n, t, r, extraDefaults),\n      i = o.client,\n      a = o.options,\n      u = o.emitter,\n      s = new Promise(function (e) {\n    var n = u.on(goalsEvent, function () {\n      u.off(goalsEvent, n), e();\n    });\n  });\n\n  if (i.waitUntilGoalsReady = function () {\n    return s;\n  }, a.fetchGoals) {\n    var c = GoalManager(o, function () {\n      return u.emit(goalsEvent);\n    });\n    r.customEventFilter = c.goalKeyExists;\n  } else u.emit(goalsEvent);\n\n  return \"complete\" !== document.readyState ? window.addEventListener(\"load\", o.start) : o.start(), window.addEventListener(\"beforeunload\", function () {\n    r.pageIsClosing = !0, i.close();\n  }), i;\n}\n\nvar createConsoleLogger$1 = createConsoleLogger,\n    version$1 = version;\n\nfunction deprecatedInitialize(e, n) {\n  var t = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n  return console && console.warn && console.warn(messages.deprecated(\"default export\", \"named LDClient export\")), initialize$1(e, n, t);\n}\n\nvar index = {\n  initialize: deprecatedInitialize,\n  version: version\n};\nexport default index;\nexport { initialize$1 as initialize, createConsoleLogger$1 as createConsoleLogger, version$1 as version };","map":null,"metadata":{},"sourceType":"module"}